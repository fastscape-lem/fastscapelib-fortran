<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.12">
<meta name="author" content="Jean Braun">
<title>FastScapeLib Documentation</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:50%;border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1><strong>FastScapeLib</strong> Documentation</h1>
<div class="details">
<span id="author" class="author">Jean Braun</span><br>
<span id="email" class="email"><a href="mailto:jbraun@gfz-potsdam.de">jbraun@gfz-potsdam.de</a></span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#install">Build and install FastScapeLib</a>
<ul class="sectlevel2">
<li><a href="#_download_the_source_files">Download the source files</a></li>
<li><a href="#_requirements">Requirements</a></li>
<li><a href="#_build_using_cmake">Build using CMake</a></li>
<li><a href="#_install_the_fortran_library">Install the Fortran library</a></li>
<li><a href="#_install_the_python_package_using_conda">Install the Python package (using conda)</a></li>
<li><a href="#_install_the_python_package_from_source">Install the Python package (from source)</a></li>
</ul>
</li>
<li><a href="#fortran-api">Fortran API</a>
<ul class="sectlevel2">
<li><a href="#_fastscape_init">FastScape_Init</a></li>
<li><a href="#_fastscape_set_nx_ny">FastScape_Set_NX_NY</a></li>
<li><a href="#_fastscape_setup">FastScape_Setup</a></li>
<li><a href="#_fastscape_set_xl_yl">FastScape_Set_XL_YL</a></li>
<li><a href="#_fastscape_set_dt">FastScape_Set_DT</a></li>
<li><a href="#_fastscape_init_h">FastScape_Init_H</a></li>
<li><a href="#_fastscape_init_f">FastScape_Init_F</a></li>
<li><a href="#_fastscape_set_erosional_parameters">FastScape_Set_Erosional_Parameters</a></li>
<li><a href="#_fastscape_set_marine_parameters">FastScape_Set_Marine_Parameters</a></li>
<li><a href="#_fastscape_set_bc">FastScape_Set_BC</a></li>
<li><a href="#_fastscape_set_u">FastScape_Set_U</a></li>
<li><a href="#_fastscape_set_v">FastScape_Set_V</a></li>
<li><a href="#_fastscape_set_precip">FastScape_Set_Precip</a></li>
<li><a href="#_fastscape_execute_step">FastScape_Execute_Step</a></li>
<li><a href="#_fastscape_get_step">FastScape_Get_Step</a></li>
<li><a href="#_fastscape_set_h">FastScape_Set_H</a></li>
<li><a href="#_fastscape_set_basement">FastScape_Set_Basement</a></li>
<li><a href="#_fastscape_set_all_layers">FastScape_Set_All_Layers</a></li>
<li><a href="#_fastscape_copy_h">FastScape_Copy_H</a></li>
<li><a href="#_fastscape_copy_f">FastScape_Copy_F</a></li>
<li><a href="#_fastscape_copy_basement">FastScape_Copy_Basement</a></li>
<li><a href="#_fastscape_copy_total_erosion">FastScape_Copy_Total_Erosion</a></li>
<li><a href="#_fastscape_reset_cumulative_erosion">FastScape_Reset_Cumulative_Erosion</a></li>
<li><a href="#_fastscape_copy_drainage_area">FastScape_Copy_Drainage_Area</a></li>
<li><a href="#_fastscape_copy_erosion_rate">FastScape_Copy_Erosion_Rate</a></li>
<li><a href="#_fastscape_copy_slope">FastScape_Copy_Slope</a></li>
<li><a href="#_fastscape_copy_curvature">FastScape_Copy_Curvature</a></li>
<li><a href="#_fastscape_copy_chi">FastScape_Copy_Chi</a></li>
<li><a href="#_fastscape_copy_catchment">FastScape_Copy_Catchment</a></li>
<li><a href="#_fastscape_copy_lake_depth">FastScape_Copy_Lake_Depth</a></li>
<li><a href="#_fastscape_get_sizes">FastScape_Get_Sizes</a></li>
<li><a href="#_fastscape_get_fluxes">FastScape_Get_Fluxes</a></li>
<li><a href="#_fastscape_view">FastScape_View</a></li>
<li><a href="#_fastscape_debug">FastScape_Debug</a></li>
<li><a href="#_fastscape_destroy">FastScape_Destroy</a></li>
<li><a href="#_fastscape_vtk">FastScape_VTK</a></li>
<li><a href="#_fastscape_strati">FastScape_Strati</a></li>
</ul>
</li>
<li><a href="#fortran-api-extra">Auxiliary routines</a>
<ul class="sectlevel2">
<li><a href="#_flexure">Flexure</a></li>
</ul>
</li>
<li><a href="#python-api">Python API</a></li>
<li><a href="#examples">Examples</a>
<ul class="sectlevel2">
<li><a href="#_mountain_f90">Mountain.f90</a></li>
<li><a href="#_margin_f90">Margin.f90</a></li>
<li><a href="#_fan_f90">Fan.f90</a></li>
<li><a href="#_dippingdyke_f90">DippingDyke.f90</a></li>
<li><a href="#_flexure_test_f90">flexure_test.f90</a></li>
<li><a href="#_fastscape_test_ipynb">FastScape_test.ipynb</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
<li><a href="#release_notes">Release notes</a>
<ul class="sectlevel2">
<li><a href="#_version_2_9_0_unreleased">Version 2.9.0 (Unreleased)</a></li>
<li><a href="#_version_2_8_2_19_may_2020">Version 2.8.2 (19 May 2020)</a></li>
<li><a href="#_version_2_8_1_13_october_2019">Version 2.8.1 (13 October 2019)</a></li>
<li><a href="#_version_2_8_0_18_september_2019">Version 2.8.0 (18 September 2019)</a></li>
<li><a href="#_version_2_7_0_30_january_2019">Version 2.7.0 (30 January 2019)</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><strong>FastScapeLib</strong> is an interface or library (i.e. a set of subroutines) to model landscape evolution by river incision, sediment transport and deposition in continental and marine environments.</p>
</div>
<div class="paragraph">
<p><strong>FastScapeLib</strong> is a set of routines that solve (a) the stream power law (SPL) that has been enriched by a sediment transport/deposition term (see Yuan et al, 2019a in <a href="#references">References</a>) (b) hillslope diffusion and (c) marine transport and deposition (see Yuan et al, 2019b in <a href="#references">References</a>), using a set of highly efficient algorithms that are all \(\mathcal{O}(n)\) complexity and implicit in time. These routines can be called from a Fortran, C or Python main program and are ideally suited to be coupled to a tectonic model, be it very simple, such as a flexural isostatic model, or very complex, such as a 3D thermo-mechanical model.</p>
</div>
<div class="paragraph">
<p>Basic partial differential equation solved by <strong>FastScapeLib</strong> is:</p>
</div>
<div class="stemblock">
<div class="content">
\[\frac{\partial h}{\partial t} = U - K_f A^m S^n + \frac{G}{A} \int_A \left(U - \frac{\partial h}{\partial t}\right) dA + K_d \nabla^2 h\]
</div>
</div>
<div class="paragraph">
<p>where \(h\) is topography, \(U\) is uplift, \(S\) is slope, \(A\) is drainage area, and \(K_f\), \(m\), \(n\), \(G\) and \(K_d\) are parameters (see further down for unit and meaning).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="install">Build and install FastScapeLib</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>FastScapeLib</strong> is not yet available as a binary package, so you need
to build and install it manually.</p>
</div>
<div class="sect2">
<h3 id="_download_the_source_files">Download the source files</h3>
<div class="paragraph">
<p>First, download the sources using git:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>git clone https://github.com/fastscape-lem/fastscapelib-fortran</pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you can visit the URL of the source repository
(<a href="https://github.com/fastscape-lem/fastscapelib-fortran" class="bare">https://github.com/fastscape-lem/fastscapelib-fortran</a>) and download
the source files as an archive (see the "clone or download button").</p>
</div>
</div>
<div class="sect2">
<h3 id="_requirements">Requirements</h3>
<div class="paragraph">
<p>To build FastScapelib, you need a Fortran compiler (e.g., <code>gfortran</code>,
part of GCC) and CMake (<a href="https://cmake.org/" class="bare">https://cmake.org/</a>). Both can easily be
installed on major platforms, e.g., using Homebrew on MacOS or apt-get
on Linux/Debian. GCC compilers are also available for Windows platforms
(see <a href="http://www.mingw.org/" class="bare">http://www.mingw.org/</a>).</p>
</div>
</div>
<div class="sect2">
<h3 id="_build_using_cmake">Build using CMake</h3>
<div class="paragraph">
<p>Run the following commands from the source directory to build the
<strong>FastScapeLib</strong> Fortran library:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>mkdir build
cd build
cmake &lt;options&gt; ..
make</pre>
</div>
</div>
<div class="paragraph">
<p>There are several build options, here shown with their default values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>-DBUILD_FASTSCAPELIB_STATIC=ON</code>: build fastscapelib as a static library</p>
</li>
<li>
<p><code>-DBUILD_FASTSCAPELIB_SHARED=OFF</code>: build fastscapelib as a shared library</p>
</li>
<li>
<p><code>-DUSE_FLEXURE=OFF</code>: include flexure routines in the library</p>
</li>
<li>
<p><code>-DBUILD_EXAMPLES=OFF</code>: "build usage examples that are in the 'examples' directory</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_install_the_fortran_library">Install the Fortran library</h3>
<div class="paragraph">
<p>If you want to install the <strong>FastScapeLib</strong> Fortran static/shared
libraries in your system, then simply run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>make install</pre>
</div>
</div>
<div class="paragraph">
<p>You should now be able to link your programs using <strong>FastScapeLib</strong>
routines, e.g., with <code>-lfastscapelib_fortran</code>. See some Fortran programs
in the 'examples' folder.</p>
</div>
</div>
<div class="sect2">
<h3 id="_install_the_python_package_using_conda">Install the Python package (using conda)</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you want to use this tool from within Python, you may consider using the
<strong>FastScape</strong> package instead, which is built on top of FastScapeLib and which
provides a high-level, user-friendly interface. See
<a href="https://fastscape.readthedocs.io" class="bare">https://fastscape.readthedocs.io</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>FastScapeLib</strong>'s Python bindings are available as a conda package
(<a href="https://docs.conda.io/en/latest/" class="bare">https://docs.conda.io/en/latest/</a>). Conda can be installed from
<a href="https://docs.conda.io/en/latest/miniconda.html" class="bare">https://docs.conda.io/en/latest/miniconda.html</a>.</p>
</div>
<div class="paragraph">
<p>Then run the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>conda install fastscapelib-f2py -c conda-forge</pre>
</div>
</div>
<div class="paragraph">
<p>You should now be able to import the package from within Python, e.g.,</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; import fastscapelib_fortran as fs</pre>
</div>
</div>
<div class="paragraph">
<p>There is a Jupyter notebook in the 'examples' folder showing simple
usage of the library.</p>
</div>
</div>
<div class="sect2">
<h3 id="_install_the_python_package_from_source">Install the Python package (from source)</h3>
<div class="paragraph">
<p>You can also install <strong>FastScapeLib</strong>'s Python bindings from source, e.g, for
development purpose. Run the following command from the source directory (i.e.,
the top-level folder containing the file <code>setup.py</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>python -m pip install .</pre>
</div>
</div>
<div class="paragraph">
<p>This will also temporarily install all the tools needed to build the package
(except a Fortran compiler, which must be already installed). Note: you need pip
&gt;= 10.</p>
</div>
<div class="paragraph">
<p>If you experience issues when installing or importing the package (NumPy
compatibility issues), try running pip without build isolation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>python -m pip install . --no-build-isolation</pre>
</div>
</div>
<div class="paragraph">
<p>Note that in this case you may first need to manually install all the tools
required to build the package (i.e., CMake, NumPy, scikit-build).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="fortran-api">Fortran API</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>FastScapeLib</strong> contains the following routines:</p>
</div>
<div class="sect2">
<h3 id="_fastscape_init">FastScape_Init</h3>
<div class="paragraph">
<p>This routine must be called first, i.e. before calling any other subroutine of the inteface. It resets internal variables.</p>
</div>
<div class="paragraph">
<p>This routine has no argument:</p>
</div>
<div class="paragraph">
<p><code>FastScape_Init ()</code></p>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_set_nx_ny">FastScape_Set_NX_NY</h3>
<div class="paragraph">
<p>This routine is used to set the resolution of the landscape evolution model. It must be called immediately after <code>FastScape_Init</code>.</p>
</div>
<div class="paragraph">
<p>Arguments:</p>
</div>
<div class="paragraph">
<p><code>FastScape_Set_NX_NY ( nx, ny)</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>nx</code> </dt>
<dd>
<p>Resolution or number of grid points in the x-direction (integer)</p>
</dd>
<dt class="hdlist1"><code>ny</code> </dt>
<dd>
<p>Resolution or number of grid points in the y-direction (integer)</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>ny</code> can be different from <code>nx</code></p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_setup">FastScape_Setup</h3>
<div class="paragraph">
<p>This routine creates internal arrays by allocating memory. It must be called right after <code>FastScape_Set_NX_NY</code>.</p>
</div>
<div class="paragraph">
<p>This routine has no argument:</p>
</div>
<div class="paragraph">
<p><code>FastScape_Setup ()</code></p>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_set_xl_yl">FastScape_Set_XL_YL</h3>
<div class="paragraph">
<p>This routine is used to set the dimensions of the model, <code>xl</code> and <code>yl</code> in meters</p>
</div>
<div class="paragraph">
<p>Arguments:</p>
</div>
<div class="paragraph">
<p><code>FastScape_Set_XL_YL ( xl, yl)</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>xl</code> </dt>
<dd>
<p>x-dimension of the model in meters (double precision)</p>
</dd>
<dt class="hdlist1"><code>yl</code> </dt>
<dd>
<p>y-dimension of the model in meters (double precision)</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_set_dt">FastScape_Set_DT</h3>
<div class="paragraph">
<p>This routine is used to set the time step in years</p>
</div>
<div class="paragraph">
<p>Arguments:</p>
</div>
<div class="paragraph">
<p><code>FastScape_Set_DT (dt)</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>dt</code> </dt>
<dd>
<p>length of the time step in years (double precision)</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_init_h">FastScape_Init_H</h3>
<div class="paragraph">
<p>This routine is used to initialize the topography in meters</p>
</div>
<div class="paragraph">
<p>Arguments:</p>
</div>
<div class="paragraph">
<p><code>FastScape_Init_H ( h)</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>h</code> </dt>
<dd>
<p>array of dimension <code>(nx*ny)</code> containing the initial topography in meters (double precision)</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_init_f">FastScape_Init_F</h3>
<div class="paragraph">
<p>This routine is used to initialize the sand-shale ratio</p>
</div>
<div class="paragraph">
<p>Arguments:</p>
</div>
<div class="paragraph">
<p><code>FastScape_Init_F( F)</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>F</code> </dt>
<dd>
<p>array of dimension <code>(nx*ny)</code> containing the initial sand-shale ratio (double precision)</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_set_erosional_parameters">FastScape_Set_Erosional_Parameters</h3>
<div class="paragraph">
<p>This routine is used to set the continental erosional parameters</p>
</div>
<div class="paragraph">
<p>Arguments:</p>
</div>
<div class="paragraph">
<p><code>FastScape_Set_Erosional_Parameters ( kf, kfsed, m, n, kd, kdsed, g, gsed, p)</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>kf</code> </dt>
<dd>
<p>array of dimension <code>(nx*ny)</code> containing the bedrock river incision (SPL) rate parameter (or Kf) in meters (to the power 1-2m) per year (double precision)</p>
</dd>
<dt class="hdlist1"><code>kfsed</code> </dt>
<dd>
<p>sediment river incision (SPL) rate parameter (or Kf) in meters (to the power 1-2m) per year (double precision); note that when <code>kfsed &lt; 0</code>, its value is not used, i.e., kf for sediment and bedrock have the same value, regardless of sediment thickness</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>bedrock refers to situations/locations where deposited sediment thickness is less than 1 meter, whereas sediment refers to situations/locations where sediment thickness is greater than 1 meter</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>m</code> </dt>
<dd>
<p>drainage area exponent in the SPL (double precision)</p>
</dd>
<dt class="hdlist1"><code>n</code> </dt>
<dd>
<p>slope exponent in the SPL (double precision)</p>
</dd>
</dl>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Valuers of <code>n</code> different from unity will cause the algorithm to perform Newton-Raphson iterations, which will cause it to slow down substantially (by a factor order <code>n</code> when <code>n &gt; 1</code>)</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>kd</code> </dt>
<dd>
<p>array of dimension <code>(nx*ny)</code>  containing the bedrock transport coefficient (or diffusivity) for hillslope processes in meter squared per year (double precision)</p>
</dd>
<dt class="hdlist1"><code>kdsed</code> </dt>
<dd>
<p>sediment transport coefficient (or diffusivity) for hillslope processes in meter squared per year (double precision; )note that when <code>kdsed &lt; 0</code>, its value is not used, i.e., kd for sediment and bedrock have the same value, regardless of sediment thickness</p>
</dd>
<dt class="hdlist1"><code>g</code> </dt>
<dd>
<p>bedrock dimensionless deposition/transport coefficient for the enriched SPL (double precision)</p>
</dd>
</dl>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When <code>g &gt; 0</code>, the algorithm requires that Gauss-Seidel iterations be performed; depending on the value of <code>g</code>, the number of iterations can be significant (from 1 when <code>g</code> is near 0 to 20 when <code>g</code> is near 1). <code>g</code> must be equal or greater than zero.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>gsed</code> </dt>
<dd>
<p>sediment dimensionless deposition/transport coefficient for the enriched SPL (double precision); note that when <code>gsed &lt; 0</code>, its value is not used, i.e., g for sediment and bedrock have the same value, regardless of sediment thickness</p>
</dd>
<dt class="hdlist1"><code>p</code> </dt>
<dd>
<p>slope exponent for multi-direction flow; the distribution of flow among potential receivers (defined as the neighbouring nodes that define a negative slope)is proportional to local slope to power <code>p</code></p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>p = 0.d0</code> corresponds to a uniform distribution of flow among receivers, regardless of the slope;</p>
</div>
<div class="paragraph">
<p><code>p = 10.d0</code> (equivalent to <code>p</code> = infinity) corresponds to single direction flow or steepest descent;</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>p = -1.d0</code> (or any negative value for <code>p</code>) corresponds to an exponent that varies with slope according to: <code>p = 0.5 + 0.6*slope</code></p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_set_marine_parameters">FastScape_Set_Marine_Parameters</h3>
<div class="paragraph">
<p>This routine is used to set the marine transport/compaction parameters</p>
</div>
<div class="paragraph">
<p>Arguments:</p>
</div>
<div class="paragraph">
<p><code>FastScape_Set_Marine_Parameters ( SL, p1, p2, z1, z2, r, L, kds1, kds2)</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>SL</code> </dt>
<dd>
<p>sea level in meters (double precision)</p>
</dd>
<dt class="hdlist1"><code>p1</code></dt>
<dd>
<p>reference/surface porosity for sand (double precision)</p>
</dd>
<dt class="hdlist1"><code>p2</code></dt>
<dd>
<p>reference/surface porosity for shale (double precision)</p>
</dd>
<dt class="hdlist1"><code>z1</code></dt>
<dd>
<p>e-folding depth for exponential porosity law for sand (double precision)</p>
</dd>
<dt class="hdlist1"><code>z2</code></dt>
<dd>
<p>e-folding depth for exponential porosity law for shale (double precision)</p>
</dd>
<dt class="hdlist1"><code>r</code> </dt>
<dd>
<p>sand-shale ratio for material leaving the continent (double precision)</p>
</dd>
<dt class="hdlist1"><code>L</code> </dt>
<dd>
<p>averaging depth/thickness needed to solve the sand-shale equation in meters (double precision)</p>
</dd>
<dt class="hdlist1"><code>kds1</code> </dt>
<dd>
<p>marine transport coefficient (diffusivity) for sand in meters squared per year (double precision)</p>
</dd>
<dt class="hdlist1"><code>kds2</code> </dt>
<dd>
<p>marine transport coefficient (diffusivity) for shale in meters squared per year (double precision)</p>
</dd>
</dl>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When <code>kds2</code> is not equal to <code>kds1</code>, it is possible that the algorithm fails to converge; the time step should be decreased until the maximum amount of sediment deposited in one time step is less than <code>L</code> the averaging depth; in theory, the convergence should not be affected when the increment in deposited sediment is higher than <code>L</code> and Xiaoping and Jean aere working on solving this problem</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_set_bc">FastScape_Set_BC</h3>
<div class="paragraph">
<p>This routine is used to set the boundary conditions</p>
</div>
<div class="paragraph">
<p>Arguments:</p>
</div>
<div class="paragraph">
<p><code>FastScape_Set_BC ( ibc)</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>ibc</code> </dt>
<dd>
<p><code>ibc</code> is made of four digits which can be one or zero (ex: <code>1111</code> or <code>0101</code> or <code>1000</code>); each digit corresponds to a type of boundary conditions (<code>0</code> = reflective and <code>1</code> = fixed height boundary); when two reflective boundaris face each other they become cyclic. The four bonudaries of the domain correspond to each of the four digits of ibc; the first one is the bottom boundary (<code>y=0</code>), the second is the right-hand side boundary (<code>x=xl</code>), the third one is the top boundary (<code>y=yl</code>) and the fourth one is the left-hand side boundary (<code>x=0</code>) (integer).</p>
</dd>
</dl>
</div>
<div id="img-bc" class="imageblock">
<div class="content">
<img src="IMAGES/BC.jpg" alt="Fan" width="300" height="200">
</div>
<div class="title">Figure 1. Order of the boundaries in argument <code>ibc</code>.</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The fixed boundary condition does not imply that the boundary cannot be uplifted; i.e. the uplift array can be finite (not nil) on fixed height boundaries. To keep a boundary at base level, this must be specified in the uplift rate array, <code>u</code>, used in <code>FastScape_Set_U (u)</code> subroutine.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_set_u">FastScape_Set_U</h3>
<div class="paragraph">
<p>This routine is used to set the uplift velocity in meters per year</p>
</div>
<div class="paragraph">
<p>Arguments:</p>
</div>
<div class="paragraph">
<p><code>FastScape_Set_U ( u)</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>u</code> </dt>
<dd>
<p>array of dimension <code>(nx*ny)</code> containing the uplift rate in meters per year (double precision)</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A fixed boundary condition does not imply that the boundary cannot be uplifted; i.e. the uplift array can be finite (not nil) on fixed height boundaries. To keep a boundary at base level, this must be specified in the uplift rate array, <code>u</code>, used in <code>FastScape_Set_U (u)</code> subroutine.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_set_v">FastScape_Set_V</h3>
<div class="paragraph">
<p>This routine is used to set the advection horizontal velocities in meters per year</p>
</div>
<div class="paragraph">
<p>Arguments:</p>
</div>
<div class="paragraph">
<p><code>FastScape_Set_V ( ux, uy)</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>ux</code> </dt>
<dd>
<p>array of dimension <code>(nx*ny)</code> containing the advection x-velocity in meters per year (double precision)</p>
</dd>
<dt class="hdlist1"><code>uy</code> </dt>
<dd>
<p>array of dimension <code>(nx*ny)</code> containing the advection y-velocity in meters per year (double precision)</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_set_precip">FastScape_Set_Precip</h3>
<div class="paragraph">
<p>This routine is used to set the precipitation rate in meters per year</p>
</div>
<div class="paragraph">
<p>Arguments:</p>
</div>
<div class="paragraph">
<p><code>FastScape_Set_Precip ( p)</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>p</code> </dt>
<dd>
<p>array of dimension <code>(nx*ny)</code> containing the relative precipitation rate, i.e. with respect to a mean value already contained in <code>Kf</code> and <code>g</code> (double precision)</p>
</dd>
</dl>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The value of this array should be considered as describing the spatial and temporal variation of relative precipitation rate, not its absolute value which is already contained in the definition of <code>Kf</code> and <code>g</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_execute_step">FastScape_Execute_Step</h3>
<div class="paragraph">
<p>This routine is used to execute one time step  of the model</p>
</div>
<div class="paragraph">
<p>This routine has no argument:</p>
</div>
<div class="paragraph">
<p><code>FastScape_Execute_Step ()</code></p>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_get_step">FastScape_Get_Step</h3>
<div class="paragraph">
<p>This routine is used to extract from the model the current time step</p>
</div>
<div class="paragraph">
<p>Arguments:</p>
</div>
<div class="paragraph">
<p><code>FastScape_Get_Step ( istep)</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>istep</code> </dt>
<dd>
<p>step number; this counter is incremented by one unit each time the routine <code>FastScape_Execute_Step</code> is called; its initial value is 0 (integer)</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_set_h">FastScape_Set_H</h3>
<div class="paragraph">
<p>This routine is used to set the topography in meters</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This routine can be used to artificially impose a value to <code>h</code> ; for example to add an uplift that is due to isostasy</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Arguments:</p>
</div>
<div class="paragraph">
<p><code>FastScape_Set_H ( h)</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>h</code> </dt>
<dd>
<p>array of dimension <code>(nx*ny)</code> containing the topography in meters (double precision)</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_set_basement">FastScape_Set_Basement</h3>
<div class="paragraph">
<p>This routine is used to set the basement height in meters</p>
</div>
<div class="paragraph">
<p>Arguments:</p>
</div>
<div class="paragraph">
<p><code>FastScape_Set_Basement ( b)</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>b</code> </dt>
<dd>
<p>array of dimension <code>(nx*ny)</code> containing the basement height in meters (double precision)</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_set_all_layers">FastScape_Set_All_Layers</h3>
<div class="paragraph">
<p>This routine is used to increment (or uplift) the topography <code>h</code>, the basement height <code>b</code> and the stratigraphic horizons</p>
</div>
<div class="paragraph">
<p>Arguments:</p>
</div>
<div class="paragraph">
<p><code>FastScape_Set_All_Layers ( dh)</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>dh</code> </dt>
<dd>
<p>array of dimension <code>(nx*ny)</code> containing the topographic increment in meters to be added to the topography <code>h</code>, the basement <code>b</code> and the stratigraphic horizons created when the <strong>Stratigraphy</strong> option has been turned on by calling the <code>FastScape_Strati</code> routine (double precision)</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_copy_h">FastScape_Copy_H</h3>
<div class="paragraph">
<p>This routine is used to extract from the model the current topography in meters</p>
</div>
<div class="paragraph">
<p>Arguments:</p>
</div>
<div class="paragraph">
<p><code>FastScape_Copy_H ( h)</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>h</code> </dt>
<dd>
<p>array of dimension <code>(nx*ny)</code> containing the extracted topography in meters (double precision)</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_copy_f">FastScape_Copy_F</h3>
<div class="paragraph">
<p>This routine is used to extract from the model the current sand-shale ratio</p>
</div>
<div class="paragraph">
<p>Arguments:</p>
</div>
<div class="paragraph">
<p><code>FastScape_Copy_F ( F)</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>F</code> </dt>
<dd>
<p>array of dimension <code>(nx*ny)</code> containing the extracted sand-shale ratio (double precision)</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_copy_basement">FastScape_Copy_Basement</h3>
<div class="paragraph">
<p>This routine is used to extract from the model the current basement height in meters</p>
</div>
<div class="paragraph">
<p>Arguments:</p>
</div>
<div class="paragraph">
<p><code>FastScape_Copy_Basement ( b)</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>b</code> </dt>
<dd>
<p>array of dimension <code>(nx*ny)</code> containing the extracted basement height in meters (double precision)</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_copy_total_erosion">FastScape_Copy_Total_Erosion</h3>
<div class="paragraph">
<p>This routine is used to extract from the model the current total erosion in meters</p>
</div>
<div class="paragraph">
<p>Arguments:</p>
</div>
<div class="paragraph">
<p><code>FastScape_Copy_Total_Erosion ( e)</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>e</code> </dt>
<dd>
<p>array of dimension <code>(nx*ny)</code> containing the extracted total erosion in meters (double precision)</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_reset_cumulative_erosion">FastScape_Reset_Cumulative_Erosion</h3>
<div class="paragraph">
<p>This routine is used to reset the total erosion to zero</p>
</div>
<div class="paragraph">
<p>This routine has no argument:</p>
</div>
<div class="paragraph">
<p><code>FastScape_Reset_Cumulative_Erosion ()</code></p>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_copy_drainage_area">FastScape_Copy_Drainage_Area</h3>
<div class="paragraph">
<p>This routine is used to extract from the model the current drainage area in meters squared</p>
</div>
<div class="paragraph">
<p>Arguments:</p>
</div>
<div class="paragraph">
<p><code>FastScape_Copy_Drainage_Area ( a)</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>a</code> </dt>
<dd>
<p>array of dimension <code>(nx*ny)</code> containing the extracted drainage area in meters squared (double precision)</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_copy_erosion_rate">FastScape_Copy_Erosion_Rate</h3>
<div class="paragraph">
<p>This routine is used to extract from the model the current erosion rate in meters per year</p>
</div>
<div class="paragraph">
<p>Arguments:</p>
</div>
<div class="paragraph">
<p><code>FastScape_Copy_Erosion_Rate ( er)</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>er</code> </dt>
<dd>
<p>array of dimension <code>(nx*ny)</code> containing the extracted erosion rate in meters per year (double precision)</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_copy_slope">FastScape_Copy_Slope</h3>
<div class="paragraph">
<p>This routine is used to extract from the model the current slope (expressed in degrees)</p>
</div>
<div class="paragraph">
<p>Arguments:</p>
</div>
<div class="paragraph">
<p><code>FastScape_Copy_Slope ( s)</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>s</code> </dt>
<dd>
<p>array of dimension <code>(nx*ny)</code> containing the extracted slope (double precision)</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_copy_curvature">FastScape_Copy_Curvature</h3>
<div class="paragraph">
<p>This routine is used to extract from the model the current curvature</p>
</div>
<div class="paragraph">
<p>Arguments:</p>
</div>
<div class="paragraph">
<p><code>FastScape_Copy_Curvature ( c)</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>c</code> </dt>
<dd>
<p>array of dimension <code>(nx*ny)</code> containing the extracted curvature (double precision)</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_copy_chi">FastScape_Copy_Chi</h3>
<div class="paragraph">
<p>This routine is used to extract from the model the current chi parameter</p>
</div>
<div class="paragraph">
<p>Arguments:</p>
</div>
<div class="paragraph">
<p><code>FastScape_Copy_Chi ( c)</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>c</code> </dt>
<dd>
<p>array of dimension <code>(nx*ny)</code> containing the extracted chi-parameter (double precision)</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_copy_catchment">FastScape_Copy_Catchment</h3>
<div class="paragraph">
<p>This routine is used to extract from the model the current catchment area in meter squared</p>
</div>
<div class="paragraph">
<p>Arguments:</p>
</div>
<div class="paragraph">
<p><code>FastScape_Copy_Catchment ( c)</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>c</code> </dt>
<dd>
<p>array of dimension <code>(nx*ny)</code> containing a different index for each catchment (double precision)</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>the catchment index is the node number (in a series going from 1 to nx*ny from bottom left corner to upper right corner) corresponding to the outlet (base level node) of the catchment</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_copy_lake_depth">FastScape_Copy_Lake_Depth</h3>
<div class="paragraph">
<p>This routine is used to extract from the model the geometry and depth of lakes (ie., regions draining into a local minimum)</p>
</div>
<div class="paragraph">
<p>Arguments:</p>
</div>
<div class="paragraph">
<p><code>FastScape_Copy_Lake_Depth ( Ld)</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>Ld</code> </dt>
<dd>
<p>array of dimension <code>(nx*ny)</code> containing the depth of lakes in meters (double precision)</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_get_sizes">FastScape_Get_Sizes</h3>
<div class="paragraph">
<p>This routine is used to extract from the model the model dimensions</p>
</div>
<div class="paragraph">
<p>Arguments:</p>
</div>
<div class="paragraph">
<p><code>FastScape_Get_Sizes ( nx, ny)</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>nx</code> </dt>
<dd>
<p>Resolution or number of grid points in the x-direction (integer)</p>
</dd>
<dt class="hdlist1"><code>ny</code> </dt>
<dd>
<p>Resolution or number of grid points in the y-direction (integer)</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_get_fluxes">FastScape_Get_Fluxes</h3>
<div class="paragraph">
<p>This routine is used to extract three fluxes from the model at the current time step: the tectonic flux which is the integral over the model of the uplift/subsidence function, the erosion flux which is the integral over the model of the erosion/deposition rate and the boundary flux which is the integral of sedimentary flux across the four boundaries (all in m<sup>3</sup>/yr)</p>
</div>
<div class="paragraph">
<p>Arguments:</p>
</div>
<div class="paragraph">
<p><code>FastScape_Get_Fluxes ( tflux, eflux, bflux)</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>tflux</code> </dt>
<dd>
<p>tectonic flux in m<sup>3</sup>/yr (double precision)</p>
</dd>
<dt class="hdlist1"><code>teflux</code> </dt>
<dd>
<p>erosion flux in m<sup>3</sup>/yr (double precision)</p>
</dd>
<dt class="hdlist1"><code>bflux</code> </dt>
<dd>
<p>boundary flux in m<sup>3</sup>/yr (double precision)</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_view">FastScape_View</h3>
<div class="paragraph">
<p>This routine is used to display on the screen basic information about the model</p>
</div>
<div class="paragraph">
<p>This routine has no argument:</p>
</div>
<div class="paragraph">
<p><code>FastScape_View ()</code></p>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_debug">FastScape_Debug</h3>
<div class="paragraph">
<p>This routine is used to display debug information and routine timing</p>
</div>
<div class="paragraph">
<p>This routine has no argument:</p>
</div>
<div class="paragraph">
<p><code>FastScape_Debug()</code></p>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_destroy">FastScape_Destroy</h3>
<div class="paragraph">
<p>This routine is used to terminate a landscape evolution model. Its main purpose is to release memory that has been previously allocated by the interface</p>
</div>
<div class="paragraph">
<p>This routine has no argument:</p>
</div>
<div class="paragraph">
<p><code>FastScape_Destroy ()</code></p>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_vtk">FastScape_VTK</h3>
<div class="paragraph">
<p>This routine creates a <code>.vtk</code> file for visualization in <strong>Paraview</strong> (see <code><a href="http://www.paraview.org" class="bare">http://www.paraview.org</a></code>); the file will be named <code>Topographyxxxxxx.vtk</code> where <code>xxxxxx</code> is the current time step number and stored in a directory called <code>VTK</code>. If  <code>vex &lt; 0</code>, it also creates other <code>.vtk</code> files named <code>Basementxxxxxx.vtk</code> (containing the basement geometry in m) and <code>SeaLevelxxxxxx.vtk</code> (containing the current sea level in m).</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If the directory <code>VTK</code> does not exist it is created</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Arguments:</p>
</div>
<div class="paragraph">
<p><code>FastScape_VTK ( f, vex)</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>f</code> </dt>
<dd>
<p>array of dimension <code>(nx*ny)</code> containing the field to be displayed on the topography (double precision)</p>
</dd>
<dt class="hdlist1"><code>vex</code> </dt>
<dd>
<p>vertical exaggeration used to scale the topographic height with respect to the horizontal coordinates (double precision)</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_strati">FastScape_Strati</h3>
<div class="paragraph">
<p>routine to produce a set of <code>.vtk</code> files containing stratigraphic information and to be opened in <strong>Paraview</strong> (see <code><a href="http://www.paraview.org" class="bare">http://www.paraview.org</a></code>). The stratigraphic files are called <code>Horizonxxx-yyyyyyy.vtk</code>, where <code>xxx</code> is the name (or number) of the horizon and <code>yyyyyyy</code> the time step. They are stored in a <code>VTK</code> directory. The name (or number) of the basement is <code>000</code> and the name of the last horizon is <code>nhorizon</code></p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If the directory <code>VTK</code> does not exist it is created</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Arguments:</p>
</div>
<div class="paragraph">
<p><code>FastScape_Strati ( nstep, nhorizon, nfreq, vex)</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>nstep</code></dt>
<dd>
<p>Total number of steps in the run (integer)</p>
</dd>
<dt class="hdlist1"><code>nhorizon</code></dt>
<dd>
<p>Total number of horizons to be stored/created (integer)</p>
</dd>
<dt class="hdlist1"><code>nfreq</code></dt>
<dd>
<p>Frequency of output of the horizons VTKs/files (integer); if <code>nfreq = 10</code>, a horizon file will be created every 10 time steps</p>
</dd>
<dt class="hdlist1"><code>vex</code></dt>
<dd>
<p>vertical exaggeration used to scale the horizons with respect to the horizontal coordinates (double precision)</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The routine <code>FastScape_Strati</code> should only be called once before the beginning of the time loop</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>What is stored on each horizon:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 10%;">
<col style="width: 20%;">
<col style="width: 70%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Field</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Description</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">H</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Topography</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Topography expressed in meters</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CurrentDepth</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Current depth expressed in meters (identical to H)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CurrentSlope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Current Slope in degrees</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ThicknessToNextHorizon</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sediment thikness from current horizon to the next horizon in meters</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ThicknessToBasement</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Total sediment thickness from current horizon/horizon to basement in meters</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DepositionalBathymetry</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bathymetry at time of deposition in meters</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DepositionalSlope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Slope at time of depostion in degrees</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DistanceToSHore</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Distance to shore at time of deposition in meters</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sand/ShaleRatio</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sand to shale ratio at time of deposition</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HorizonAge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Age of the current horizon in years</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ThicknessErodedBelow</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sediment thickness eroded below current horizon in meters</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="fortran-api-extra">Auxiliary routines</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_flexure">Flexure</h3>
<div class="paragraph">
<p>We provide a Fortran subroutine called <code>flexure</code> to compute the flexural isostatic rebound associated with erosional loading/unloading. To use this routine, you need to enable the CMake option <code>-DUSE_FLEXURE=ON</code> when building <strong>FastScapeLib</strong> (see <a href="#install">Build and install FastScapeLib</a> section). By default, flexure is not part of the <strong>FastScapeLib</strong> library as it rather corresponds to a simple example of a tectonic model that uses the library interface.</p>
</div>
<div class="paragraph">
<p>Here we only describe the main subroutine. It takes an initial (at time <code>t</code>) and final topography (at time <code>t+Dt</code>) (i.e. before and after erosion/deposition) and returns a corrected final topography that includes the effect of erosional/depositional unloading/loading.</p>
</div>
<div class="paragraph">
<p>The routine assumes a value of 10<sup>11</sup> Pa for Young&#8217;s modulus, 0.25 for Poisson&#8217;s ratio and 9.81 m/s<sup>2</sup> for g, the gravitational acceleration. It uses a spectral method to solve the bi-harmonic equation governing the bending/flexure of a thin elastic plate floating on an inviscid fluid (the asthenosphere).</p>
</div>
<div class="paragraph">
<p>Arguments:</p>
</div>
<div class="paragraph">
<p><code>flexure ( h, hp, nx, ny, xl, yl, rhos, rhoa, eet, ibc)</code></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>h</code> </dt>
<dd>
<p>array of dimension (<code>nx*ny</code>) containing the topography at time <code>t+Dt</code>; on return it will be replaced by the topography at time t+Dt corrected for isostatic rebound (double precision)</p>
</dd>
<dt class="hdlist1"><code>hp</code> </dt>
<dd>
<p>array of dimension (<code>nx*ny</code>) containing the topography at time <code>t</code>, assumed to be at isostatic equilibrium (double precision)</p>
</dd>
<dt class="hdlist1"><code>nx</code> </dt>
<dd>
<p>model topography (<code>h</code>) resolution or number of grid points in the x-direction (integer)</p>
</dd>
<dt class="hdlist1"><code>ny</code> </dt>
<dd>
<p>model topography (<code>h</code>) resolution or number of grid points in the y-direction (integer)</p>
</dd>
<dt class="hdlist1"><code>xl</code> </dt>
<dd>
<p>x-dimension of the model topography in meters (double precision)</p>
</dd>
<dt class="hdlist1"><code>yl</code> </dt>
<dd>
<p>y-dimension of the model topography in meters (double precision)</p>
</dd>
<dt class="hdlist1"><code>rhos</code> </dt>
<dd>
<p>array of dimension(<code>nx*ny</code>) containing the surface rock density in kg/m<sup>3</sup> (double precision)</p>
</dd>
<dt class="hdlist1"><code>rhoa</code> </dt>
<dd>
<p>asthenospheric rhoc density in kg/m<sup>3</sup> (double precision)</p>
</dd>
<dt class="hdlist1"><code>eet</code> </dt>
<dd>
<p>effective elastic plate thickness in m (double precision)</p>
</dd>
<dt class="hdlist1"><code>ibc</code> </dt>
<dd>
<p>same as in <a href="#_fastscape_set_bc">FastScape_Set_BC</a></p>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="python-api">Python API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>All <strong>FastScapeLib</strong> routines above can be called from within
Python. See <a href="#install">Build and install FastScapeLib</a> section for more
details on how install the Python package. See also the Jupyter
Notebook in the <code>examples</code> directory for further instructions on how
to use <strong>FastScapeLib</strong> from within Python.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note that all routine names must be in lower caps in
the calling python code.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="examples">Examples</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Several examples are provided in the <code>examples</code> directory. They are meant to be used as templates by the user. To compile them, use the CMake option <code>-DBUILD_EXAMPLES=ON</code> (see <a href="#install">Build and install FastScapeLib</a> section for more details). This creates executables in the <code>examples</code> subfolder of your build directory. To run one of those examples, e.g., <code>Mountain</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>rm VTK/*.vtk
./Mountain</pre>
</div>
</div>
<div class="paragraph">
<p>The first line is needed to remove any pre-existing <code>.vtk</code> file in the <code>VTK</code> directory.</p>
</div>
<div class="sect2">
<h3 id="_mountain_f90">Mountain.f90</h3>
<div class="paragraph">
<p>This is the basic square mountain problem where a landscape is formed by a uniform uplift, all four boundaries being kept at base level. The resolution is medium (400x400). The SPL is non linear (n = 1.5) but no sediment effect is included (g = 0). Single direction flow is selected by setting <code>expp = 10</code>. The model run lasts for 10 Myr (100 time steps of 100 kyr each).</p>
</div>
<div class="paragraph">
<p>This model should run in approximately 90-100 seconds on a reasonably fast modern computer.</p>
</div>
</div>
<div class="sect2">
<h3 id="_margin_f90">Margin.f90</h3>
<div class="paragraph">
<p>Example showing the use of the Marine component of <strong>FastScapeLib</strong>.</p>
</div>
<div class="paragraph">
<p>An area of 100x150 km is set to uplift on one half only. The other half is 1000 m below sea level and accumulate sediment eroded from the uplifting area. The erosion model is nonlinear (n = 2) and sediment transport affects erosion (g = 1). Multiple direction flow is selected. Marine transport is 10 x more efficient for silt than sand. No compaction. Resolution is 100x150. Boundary conditions are no flux boundaries except along the bottom boundary where base level is fixed at -1000 m.</p>
</div>
<div class="paragraph">
<p>This model should run in approximately 90-95 seconds on a reasonably fast modern computer.</p>
</div>
</div>
<div class="sect2">
<h3 id="_fan_f90">Fan.f90</h3>
<div class="paragraph">
<p>Example of the use of the continental transport/deposition component of <strong>FastScapeLib</strong>.</p>
</div>
<div class="paragraph">
<p>Here we create a sedimentary fan at the base of an initially 1000 m high plateau. The model is relatively small (10x20 km) and low resolution (101x201). The erosion law is linear (n = 1) but sediments are more easily eroded (by a factor 1.5). Sediment transport/deposition is strong (g = 1). Multiple direction flow is selected. Boundary conditions are no flux on the top boundary, cyclic on the left and right boundaries and fixed height along the bottom boundary where base level is fixed at sea level (0 m).</p>
</div>
<div class="paragraph">
<p>This model should run in approximately 12 seconds on a reasonably fast modern computer.</p>
</div>
</div>
<div class="sect2">
<h3 id="_dippingdyke_f90">DippingDyke.f90</h3>
<div class="paragraph">
<p>Example of the use of spatially and temporally variable erodibility</p>
</div>
<div class="paragraph">
<p>Here we look at the effect of a resistant dyke dipping at 30 degree angle and being progressively exhumed. The dyke&#8217;s surface expression progressively traverses the landscape and affects the drainage pattern.</p>
</div>
<div class="paragraph">
<p>The model, otherwise, is very simple: block uplift, all boundaries at base level, linear SPL, multiple direction flow and no sediment.</p>
</div>
<div class="paragraph">
<p>This model should run in approximately 25 seconds on a reasonably fast modern computer.</p>
</div>
</div>
<div class="sect2">
<h3 id="_flexure_test_f90">flexure_test.f90</h3>
<div class="paragraph">
<p>This example shows how to use <code>flexure</code> but also how it interacts with <strong>FastScapeLib</strong>: the flexure module needs the topography computed by <strong>FastScapeLib</strong> as input to <code>flexure</code> but the user also needs to set the topography and basement geometry to the new values estimated by <code>flexure</code>. Running this model creates an ASCII file (<code>Fluxes.txt</code>) containing the fluxes coming out of the model.</p>
</div>
<div class="paragraph">
<p>This model should run in approximately 6 minutes on a reasonably fast modern computer.</p>
</div>
</div>
<div class="sect2">
<h3 id="_fastscape_test_ipynb">FastScape_test.ipynb</h3>
<div class="paragraph">
<p>This Jupyter notebook contains a simple (low resolution) example where the right-hand side of a rectangular model is an initially 100 m high plateau subjected to erosion, while the left-hand side is kept fixed at base level. The SPL is linear (<code>n = 1</code>) but completed by a sediment transport/deposition algoithm with <code>g = 1</code>.</p>
</div>
<div class="paragraph">
<p>Boundary conditions are closed except for the left hand-side (boundary number 4) set to base level.</p>
</div>
<div class="paragraph">
<p>The model is run for 200 time steps and the results are stored in <code>.vtk</code> files where the drainage area is also stored.</p>
</div>
<div class="paragraph">
<p>The drainage area of the last time step is also shown as a contour plot as shown in Figure <a href="#img-FastScapePyhton">Fan example.</a></p>
</div>
<div id="img-FastScapePyhton" class="imageblock">
<div class="content">
<img src="images/FastScapePython.jpg" alt="FastScapePyhton" width="600" height="300">
</div>
<div class="title">Figure 2. Fan example.</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="references">References</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://www.sciencedirect.com/science/article/pii/S0169555X12004618">Braun, J. and Willett, S.D., 2013.</a> A very efficient, O(n), implicit and parallel method to solve the basic stream power law equation governing fluvial incision and landscape evolution. Geomorphology, 180-181, pp., 170-179.</p>
</li>
<li>
<p><a href="https://doi.org/10.5194/esurf-7-549-2019">Cordonnier, G., Bovy, B. and Braun, J., 2019.</a> A versatile, linear complexity algorithm for flow routing in topographies with depressions. Earth Surf. Dynam., 7, pp. 549562.</p>
</li>
<li>
<p><a href="https://doi.org/10.1029/2018JF004867">Yuan, X., Braun, J., Guerit, L., Rouby, D. and Cordonnier, G., 2019.</a> A New Efficient Method to Solve the Stream Power Law Model Taking Into Account Sediment Deposition. Journal of Geohysical Research - Surface, 124 (6), pp. 1346-1365.</p>
</li>
<li>
<p><a href="https://doi.org/10.1016/j.epsl.2019.115728">Yuan, X., Braun, J., Guerit, L., Simon, B., Bovy, B., Rouby, D., Robin, C. and Jiao, R., 2019.</a> Linking continental deposition to marine sediment transport and deposition: a new implicit and o(n) method for inverse analysis. Earth and Planetary Science Letters, 524, 115728.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="release_notes">Release notes</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_version_2_9_0_unreleased">Version 2.9.0 (Unreleased)</h3>
<div class="sect3">
<h4 id="_changes">Changes</h4>

</div>
<div class="sect3">
<h4 id="_bug_fixes">Bug fixes</h4>

</div>
</div>
<div class="sect2">
<h3 id="_version_2_8_2_19_may_2020">Version 2.8.2 (19 May 2020)</h3>
<div class="sect3">
<h4 id="_changes_2">Changes</h4>
<div class="ulist">
<ul>
<li>
<p>Improved the documentation on installing Python bindings #37</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_bug_fixes_2">Bug fixes</h4>
<div class="ulist">
<ul>
<li>
<p>Made internal changes for more flexibility downstream #25</p>
</li>
<li>
<p>Refactored boundary conditions #33</p>
</li>
<li>
<p>Fixed boundary conditions in flexure #34</p>
</li>
<li>
<p>Explicit deallocation of arrays in StreamPowerLaw routines #35</p>
</li>
<li>
<p>Fixed some build issues with recent NumPy versions #37</p>
</li>
<li>
<p>Simplified CMake script for building the Python extension #37</p>
</li>
<li>
<p>Moved lake depth computation in flow routing subroutines #38</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_version_2_8_1_13_october_2019">Version 2.8.1 (13 October 2019)</h3>
<div class="sect3">
<h4 id="_bug_fixes_3">Bug fixes</h4>
<div class="ulist">
<ul>
<li>
<p>Fixed regression with boundary conditions and StreamPowerLaw #29</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_version_2_8_0_18_september_2019">Version 2.8.0 (18 September 2019)</h3>
<div class="sect3">
<h4 id="_changes_3">Changes</h4>
<div class="ulist">
<ul>
<li>
<p>Refactor stream power law implementation (decouple from flow
routing) #23</p>
</li>
<li>
<p>Rename Union internal subroutine (could cause name conflicts when
building the library with f2py) #22</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_new_features">New features</h4>
<div class="ulist">
<ul>
<li>
<p>New routines for computing curvature and slope #15</p>
</li>
<li>
<p>New component for marine sediment transport and deposition #20</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_bug_fixes_4">Bug fixes</h4>
<div class="ulist">
<ul>
<li>
<p>Fixed VTK files export on Windows #7</p>
</li>
<li>
<p>Improved efficiency of stream power law erosion and flexure #8</p>
</li>
<li>
<p>Fixed bug in lake filling algorithm #12</p>
</li>
<li>
<p>Fixed bug in ADI implementation of diffusion #17</p>
</li>
<li>
<p>Fixed bug in Strati subroutine #18</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_version_2_7_0_30_january_2019">Version 2.7.0 (30 January 2019)</h3>
<div class="ulist">
<ul>
<li>
<p>First release in VCS.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2021-04-26 08:25:42 UTC
</div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains("stemblock")) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</body>
</html>